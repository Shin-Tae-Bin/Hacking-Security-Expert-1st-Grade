# 3강: 보안취약점(서버보안 UNIX) 01

## 개요
UNIX 서버의 기본적인 보안 취약점과 대응 방안을 다루는 첫 번째 강의입니다. 계정 관리와 패스워드 정책을 중심으로 학습합니다.

## 주요 내용

### 1. Root 계정 원격 접속 제한

#### 취약점 개요
- **위험도**: 높음
- **위협 영향**: 시스템 관리자 권한 획득

#### 보안 이슈
- root는 시스템의 모든 권한을 가진 슈퍼유저
- 직접 로그인 허용 시 불법 침입자의 주요 타겟이 됨
- 원격 접속 허용은 공격자에게 더 좋은 기회 제공

#### 대응 방안
```bash
# /etc/ssh/sshd_config 파일 수정
PermitRootLogin no

# 서비스 재시작
systemctl restart sshd
```

### 2. Root 계정 su 제한

#### 취약점 개요
- **위험도**: 중간
- **위협 영향**: 시스템 관리자 권한 획득

#### 보안 이슈
- su 명령어를 통해 root 권한으로 전환 가능
- 모든 사용자가 su 명령어 사용 가능할 경우 위험
- 허용된 계정만 su 명령어 사용 가능하도록 제한 필요

#### 대응 방안
```bash
# wheel 그룹 설정
groupadd wheel
usermod -G wheel [사용자명]

# /etc/pam.d/su 파일 수정
auth required pam_wheel.so use_uid
```

### 3. 패스워드 최소 길이 설정

#### 취약점 개요
- **위험도**: 중간
- **위협 영향**: 패스워드 노출로 인한 계정 권한 획득

#### 보안 이슈
- 짧은 패스워드는 무작위 공격(Brute Force)에 취약
- 패스워드 추측(Guessing) 공격 대응 필요
- 모든 계정에 패스워드 존재 확인 필요

#### 대응 방안
```bash
# /etc/login.defs 파일 수정
PASS_MIN_LEN 8

# 패스워드 없는 계정 확인
awk -F: '$2 == ""' /etc/shadow
```

### 4. 패스워드 최대 사용 기간 설정

#### 취약점 개요
- **위험도**: 중간
- **위협 영향**: 패스워드 추측 가능성 높아짐

#### 보안 이슈
- 장기간 동일한 패스워드 사용 시 노출 위험 증가
- 암호화된 패스워드 파일 유출 시에도 주기적 변경으로 보호 가능
- 적절한 변경 주기 설정 필요 (보안 vs 편의성)

#### 대응 방안
```bash
# /etc/login.defs 파일 수정
PASS_MAX_DAYS 90

# 기존 계정에 적용
chage -M 90 [사용자명]
```

### 5. 패스워드 최소 사용 기간 설정

#### 취약점 개요
- **위험도**: 낮음
- **위협 영향**: 취약한 계정을 통해 계정 권한 도용

#### 보안 이슈
- 사용자가 연속적으로 패스워드 변경하여 이전 패스워드 재사용 방지
- 최근 패스워드 기억 설정과 함께 사용해야 효과적
- 최소 사용 기간을 0보다 큰 값으로 설정 필요

#### 대응 방안
```bash
# /etc/login.defs 파일 수정
PASS_MIN_DAYS 1

# 기존 계정에 적용
chage -m 1 [사용자명]
```

### 6. 패스워드 복잡성 설정

#### 취약점 개요
- **위험도**: 높음
- **위험 영향**: 공격자가 암호를 쉽게 해독하여 임의의 명령어 실행, 파일 수정, 관리자 권한 획득

#### 보안 이슈
- 영숫자만으로 구성된 암호는 쉽게 해독 가능
- 다양한 문자 조합으로 경우의 수 증가 필요
- 최소 8자 이상, 특수문자 포함 권장

#### 대응 방안
```bash
# /etc/pam.d/passwd 파일 수정
password requisite pam_cracklib.so retry=3 minlen=8 dcredit=-1 ucredit=-1 lcredit=-1 ocredit=-1
```

### 7. 불필요한 계정 제거

#### 취약점 개요
- **위험도**: 중간
- **위협 영향**: 관리되지 않는 계정을 통한 시스템 접속

#### 보안 이슈
- 오랫동안 로그인하지 않은 계정의 관리 소홀
- 퇴직자, 테스트 계정 등 불필요한 계정 존재
- 반복된 로그인 실패 기록이 있는 계정

#### 대응 방안
```bash
# 불필요한 계정 확인
lastlog | grep "Never"
awk -F: '$3 >= 1000' /etc/passwd

# 계정 삭제
userdel -r [사용자명]
```

### 8. 관리자 그룹에 최소한의 계정 포함

#### 취약점 개요
- **위험도**: 중간
- **위협 영향**: 일반사용자에 관리자 권한 부여

#### 보안 이슈
- root가 속한 그룹은 시스템 운영에 필요한 파일 접근 권한 보유
- 일반사용자가 해당 그룹에 속할 경우 시스템 파일 접근 가능
- 최소한의 필요 계정만 포함해야 함

#### 대응 방안
```bash
# root 그룹 구성원 확인
grep "^root:" /etc/group

# 불필요한 계정 제거
gpasswd -d [사용자명] root
```

## 점검 스크립트 예시

```bash
#!/bin/bash
# UNIX 보안 점검 스크립트

echo "=== UNIX 서버 보안 점검 시작 ==="

# 1. Root 원격 접속 확인
echo "1. Root 원격 접속 설정 확인"
grep "PermitRootLogin" /etc/ssh/sshd_config

# 2. 패스워드 정책 확인
echo "2. 패스워드 정책 확인"
grep -E "PASS_MAX_DAYS|PASS_MIN_DAYS|PASS_MIN_LEN" /etc/login.defs

# 3. 패스워드 없는 계정 확인
echo "3. 패스워드 없는 계정 확인"
awk -F: '$2 == ""' /etc/shadow

# 4. 불필요한 계정 확인 (90일 이상 미사용)
echo "4. 장기간 미사용 계정 확인"
lastlog | awk '$2 ~ /Never/ || $4 < systime() - 90*24*3600 {print $1}'

echo "=== UNIX 서버 보안 점검 완료 ==="
```

## 참고 자료

### 주요 설정 파일
- `/etc/passwd`: 사용자 계정 정보
- `/etc/shadow`: 암호화된 패스워드 정보
- `/etc/group`: 그룹 정보
- `/etc/login.defs`: 패스워드 정책 설정
- `/etc/ssh/sshd_config`: SSH 서비스 설정

### 관련 명령어
- `useradd`, `userdel`, `usermod`: 사용자 계정 관리
- `passwd`, `chage`: 패스워드 관리
- `groupadd`, `groupdel`, `gpasswd`: 그룹 관리
- `lastlog`, `last`: 로그인 기록 확인